{\ttfamily \raggedright \small
001 using\ \textbf{namespace}\ Dyninst;\\
002 using\ \textbf{namespace}\ DepGraphAPI;\\
003 \ \\
004 \textsl{//\ Assume\ this\ represents\ a\ function\ of\ interest}\\
005 BPatch\underline\ function\ $\ast$func;\\
006 \textsl{//\ And\ an\ address\ of\ an\ instruction\ of\ interest}\\
007 Address\ insnAddr;\\
008 \textsl{//\ And\ a\ register\ defined\ by\ the\ previous\ instruction}\\
009 InstructionAPI::RegisterAST::Ptr\ reg;\\
010 \ \\
011 \textsl{//\ Access\ the\ PDG\ for\ this\ function}\\
012 PDG::Ptr\ pdg\ =\ PDG::analyze(func);\\
013 \ \\
014 \textsl{//\ Find\ the\ node\ of\ interest}\\
015 NodeIterator\ nodeBegin,\ nodeEnd;\\
016 pdg-{}>{}find(insnAddr,\ reg,\ nodeBegin,\ nodeEnd);\\
017 \ \\
018 \textsl{//\ Make\ sure\ we\ found\ a\ node...}\\
019 \textbf{if}\ (nodeBegin\ ==\ nodeEnd)\ \{\\
020 \ \ \ \ \textsl{//\ Complain}\\
021 \}\\
022 \ \\
023 \textsl{//\ Create\ the\ forward\ slice\ from\ the\ node\ of\ interest}\\
024 NodeIterator\ sliceBegin,\ sliceEnd;\\
025 pdg-{}>{}forwardClosure($\ast$nodeBegin,\ sliceBegin,\ sliceEnd);\\
026 \ \\
027 \textsl{//\ Iterate\ over\ each\ node\ in\ the\ closure\ and\ do\ something}\\
028 \textbf{for}\ (;\ sliceBegin\ !=\ sliceEnd;\ sliceBegin++)\ \{\\
029 \ \ \ \ \textsl{//\ ...}\\
030 \}\\
031 \ \\
032  }
\normalfont\normalsize

